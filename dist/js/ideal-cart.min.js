!function(t){function e(){for(var t=0,e=0;e<this.items.length;e++)t+=this.items[e].getTotalIncludingTax();return t}function i(){for(var t=0,e=0;e<this.items.length;e++)t+=this.items[e].getTotalExcludingTax();return t}function n(){for(var t=0,e=0;e<this.items.length;e++)t+=this.items[e].getTotalDiscounts();return t}function s(){for(var t=0,e=0;e<this.items.length;e++)t+=this.items[e].getTotalTax();return t}function r(t){var e=this;if("undefined"==typeof t||null===t)throw"invalid item passed";if(t instanceof m.orderItem)if(this.hasItem(t.get("id"))){var i=this.getItem(t.get("id"));i.increment(t.get("quantity"))}else e.trigger("beforeAdd",t),e.items.push(t),e.trigger("afterAdd",t);else if("object"==typeof t)if(t=new m.orderItem(t),this.hasItem(t.get("id"))){var i=this.getItem(t.get("id"));i.increment(t.get("quantity"))}else e.trigger("beforeAdd",t),e.items.push(t),e.trigger("afterAdd",t);return this}function o(t){for(var e=0;e<this.items.length;e++)if(this.items[e].get("id")===t)return!0;return!1}function a(t){for(var e=0;e<this.items.length;e++)if(this.items[e].get("id")===t)return this.items[e];throw new Error("Item not found")}function u(t){for(var e=0;e<this.items.length;e++)if(this.items[e].get("id")===t)return this.items.splice(e,1),!0;return!1}function h(){return this.items.length}function c(){for(var t=0,e=0;e<this.items.length;e++)t+=this.items[e].get("quantity");return t}function f(){return this.items}function l(){var t={};t.items=[];for(var e=0;e<this.items.length;e++)t.items.push(this.items[e].serialize());return t}function g(){var t=this.order;t.totalIncludingTax=this.getTotalIncludingTax(),t.totalExcludingTax=this.getTotalExcludingTax(),t.totalDiscounts=this.getTotalDiscounts(),t.totalTax=this.getTotalTax(),t.totalItems=this.getTotalItems(),t.totalUniqueItems=this.getTotalUniqueItems(),t.items=[];for(var e=0;e<this.items.length;e++)t.items.push(this.items[e].format());return t}function d(t){if("undefined"!=typeof t.items)for(var e=0;e<t.items.length;e++)this.addItem(t.items[e])}var m=t.idealCart||function(){this.items=[],this.order=new m.order};t.idealCart=m;var p;!function(t){var e;!function(t){t.ucfirst=function(t){return t.charAt(0).toUpperCase()+t.slice(1)}}(e=t.Methods||(t.Methods={}))}(p=m._Util||(m._Util={}));this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype,t.prototype=new i};m.prototype={bind:function(t,e){this._events=this._events||{},this._events[t]=this._events[t]||[],this._events[t].push(e)},unbind:function(t,e){this._events=this._events||{},t in this._events!=!1&&this._events[t].splice(this._events[t].indexOf(e),1)},trigger:function(t){if(this._events=this._events||{},t in this._events!=!1)for(var e=0;e<this._events[t].length;e++)this._events[t][e].apply(this,Array.prototype.slice.call(arguments,1))}},m.prototype.addItem=r,m.prototype.getItem=a,m.prototype.getItems=f,m.prototype.hasItem=o,m.prototype.getTotalUniqueItems=h,m.prototype.getTotalItems=c,m.prototype.removeItem=u,m.prototype.getTotalIncludingTax=e,m.prototype.getTotalExcludingTax=i,m.prototype.getTotalDiscounts=n,m.prototype.getTotalTax=s,m.prototype.serialize=l,m.prototype.unserialize=d,m.prototype.format=g,m.money=function(t){var e;this.get=function(){return e},this.set=function(t){e=t},this.getMoney=function(){var e=Number(t);if(isNan(e))throw"Invalid number";return parseInt(100*number)},this.set(t)};m.orderItem=function(t){"use strict";function e(t){if(i(),"object"==typeof t&&null!==t)for(var e in t)t.hasOwnProperty(e)&&r.set(e,t[e])}function i(){s.options=s.options||{},s.discounts=s.discounts||[]}var n=["id","code","name","description","price","quantity","tax","taxRate"],s={},r=this;this.setPrice=function(t){return s.price=Number(t),this},this.setQuantity=function(t){s.quantity=parseInt(t)},this.set=function(t,e){var i=n.indexOf(t),o="set"+m._Util.Methods.ucfirst(t.toLowerCase());return"undefined"!=typeof r[o]&&"function"==typeof r[o]?r[o](e):-1!==i?(s[t]=e,this):(s.options[t]=e,this)},this.get=function(t){if("undefined"!=typeof s[t])return s[t];throw new Error(t+" does not exist")},this.increment=function(t){return"undefined"!=typeof t?s.quantity+=t:s.quantity++,this},this.decrement=function(){return s.quantity--,this},this.addDiscount=function(){},this.serialize=function(){return s},this.unserialize=function(t){return s=t,i(),this},this.getTotalIncludingTax=function(){return this.getTotalExcludingTax()+this.getTotalTax()},this.getTotalExcludingTax=function(){return this.get("quantity")*this.get("price")-this.getTotalDiscounts()},this.getTotalDiscounts=function(){return 0},this.getTotalTax=function(){var t;try{return t=this.get("tax")}catch(e){try{var i=this.get("taxRate")/100;return this.getTotalExcludingTax()*i}catch(e){return 0}}},this.format=function(){var t=this.serialize();return t.totalIncludingTax=this.getTotalIncludingTax(),t.totalExcludingTax=this.getTotalExcludingTax(),t.totalDiscounts=this.getTotalDiscounts(),t.totalTax=this.getTotalTax(),t},e(t)},m.order=function(){"use strict";this.startDate=new Date,this.type="order"}}(window);